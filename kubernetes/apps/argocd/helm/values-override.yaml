# Install resources in "argocd" namespace
namespaceOverride: argocd

global:
  domain: argocd.icantkube.help

# Disable Argocd's internal TLS to avoid redirect loops (cloudflare now handles tls termination)
configs:
  params:
    server.insecure: true

  cm:
    exec.enabled: true

server:
  # Enable Ingress and set it to use strrl cloudflare ingress controller
  ingress:
    hostname: argocd.icantkube.help
    enabled: true
    ingressClassName: cloudflare-tunnel
    annotations:
      cloudflare-tunnel-ingress-controller.strrl.dev/backend-protocol: "http"
      cloudflare-tunnel-ingress-controller.strrl.dev/proxy-ssl-verify: "on"

  extensions:
    enabled: true
    extensionList:
      - name: rollout-extension
        env:
          - name: EXTENSION_URL
            value: https://github.com/argoproj-labs/rollout-extension/releases/download/v0.3.7/extension.tar